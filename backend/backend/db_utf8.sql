CREATE TABLE IF NOT EXISTS antibiogramas (
  id SERIAL PRIMARY KEY,
  nombre TEXT UNIQUE NOT NULL
);

CREATE TABLE IF NOT EXISTS antibioticos (
  codigo TEXT PRIMARY KEY,
  nombre TEXT NOT NULL,
  cantidad INT NOT NULL DEFAULT 0,
  stock_minimo INT NOT NULL DEFAULT 0
);

-- Compatibilidad: si la tabla ya existe sin estas columnas.
ALTER TABLE antibioticos ADD COLUMN IF NOT EXISTS cantidad INT NOT NULL DEFAULT 0;
ALTER TABLE antibioticos ADD COLUMN IF NOT EXISTS stock_minimo INT NOT NULL DEFAULT 0;

CREATE TABLE IF NOT EXISTS antibiograma_antibiotico (
  antibiograma_id INT NOT NULL REFERENCES antibiogramas(id) ON DELETE CASCADE,
  antibiotico_codigo TEXT NOT NULL REFERENCES antibioticos(codigo) ON DELETE CASCADE,
  PRIMARY KEY (antibiograma_id, antibiotico_codigo)
);

INSERT INTO antibiogramas (nombre) VALUES
('ATB CORINEBACTERIAS'),
('ATB MORAXELLA'),
('ATB ESTREPTOCOCOS'),
('ATB MENINGOCOCO'),
('ATB GONOCOCO'),
('ATB HAEMOPHILUS'),
('ATB PSEUDOMONAS'),
('ATB AEROCOCUS')
ON CONFLICT (nombre) DO NOTHING;

-- Carga mÃ­nima de antibiÃ³ticos (puedes ampliar con la lista completa)
INSERT INTO antibioticos (codigo, nombre) VALUES
('412219','AMIKACINA'),
('423446','AMOXICILINA / AC. CLAVULANICO EU'),
('412243','AMOXICILINA'),
('412251','AMPICILINA/SULBACTAM'),
('412253','AMPICILINA'),
('412257','AZITROMICINA'),
('412259','AZTREONAM'),
('412265','BENCILPENICILINA 32'),
('412263','BENCILPENICILINA 256'),
('412273','CEFEPIMA'),
('412275','CEFIXIMA'),
('412281','CEFOTAXIMA'),
('412285','CEFOXITINA'),
('412289','CEFPODOXIMA'),
('424000','CEFTAROLINA'),
('412293','CEFTAZIDIMA'),
('419556','CEFTAZIDIMA / AVIBACTAM'),
('414447','CEFTOLOZANO / TAZOBACTAM'),
('412301','CEFTRIAXONA 256'),
('412303','CEFTRIAXONA 32'),
('412305','CEFUROXIMA'),
('412307','CEFALOTINA'),
('412309','CLORAMFENICOL'),
('412311','CIPROFLOXACINO'),
('412313','CLARITROMICINA'),
('412315','CLINDAMICINA'),
('412324','DAPTOMICINA'),
('421771','DELAFLOXACINO'),
('412326','DORIPENEM'),
('412328','DOXICICLINA'),
('421552','ERAVACICLINA'),
('412332','ERTAPENEM'),
('66448','ERITROMICINA'),
('423442','FOSFOMICINA'),
('424004','GENTAMICINA 1024'),
('412368','GENTAMICINA 256'),
('412374','IMIPENEM'),
('420925','IMIPENEM RELEBACTAM'),
('412382','KANAMICINA'),
('412393','LEVOFLOXACINO'),
('412396','LINEZOLID'),
('424030','MECILLINAM'),
('412402','MEROPENEM'),
('421563','MEROPENEM/VABORBACTAM'),
('412404','METRONIDAZOL'),
('412409','MINOCICLINA'),
('412411','MOXIFLOXACINO'),
('424011','MUPIROCIN'),
('424022','ÃCIDO NALIDÃXICO'),
('412422','NETILMICINA'),
('424018','NITROFURANTOINA'),
('424024','NORFLOXACINO'),
('412430','OFLOXACINO'),
('412432','OXACILINA'),
('412436','PIPERACILINA'),
('421166','PIPERACILINA/TAZOBACTAM'),
('412444','QUINUPRISTINA/DALFOPRISTINA'),
('412450','RIFAMPICINA'),
('412452','ESPECTINOMICINA'),
('424015','ESTREPTOMICINA'),
('412461','TEICOPLANINA'),
('424010','TEMOCILINA'),
('412471','TETRACICLINA'),
('412473','TICARCILINA/ACIDO CLAVULANICO'),
('424314','TIGECICLINA'),
('412479','TOBRAMICINA 256'),
('424013','TOBRAMICINA 1024'),
('412481','TRIMETOPRIM/SULFAMETOXAZOL'),
('412483','TRIMETOPRIM'),
('412488','VANCOMICINA')
ON CONFLICT (codigo) DO NOTHING;
